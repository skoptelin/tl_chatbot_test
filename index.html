<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport">
  </head>
  <body>
    <style>
      .button_box {
        position: fixed;
        display: flex;
        flex-direction: column;
        top: 50%;
        left: 50%;
      }
      .button_box button {
        height: 48px;
        border: 1px solid black;
        margin-bottom: 20px;
        cursor: pointer;
      }
    </style>
    <div class="button_box">
      <button class="t396__elem" data-elem-id="1622986986995">Кнопка 1</button>
      <button class="t-btn" id="button2" data-buttonfieldset="button2">Кнопка 2</button>
      <button class="button3">Кнопка 3</button>
      <button class="t776__btn-wrapper t-btn_sm">Кнопка 4</button>
      <button class="t776__btn-wrapper">Кнопка 5</button>
    </div>
    <script src="https://bot.jaicp.com/chatwidget/uEkMjVpG:8b07b27d33364b439329985b0220b3e49f9111f9/justwidget.js" async></script>
    <script src='https://salebot.pro/js/salebot.js?v=1' charset='utf-8'></script>
    <script>
      SaleBotPro.init({
        onlineChatId: '4859'
      });
    </script>
    <script>
      const apiKey = '788375de0dd3b5a8207a6f917991d5f4';
      const urlSaveVariables = `https://lesli-unpersonifying-tridimensionally.ngrok-free.dev/api/${apiKey}/save_variables`;
      const urlFindClient = `https://lesli-unpersonifying-tridimensionally.ngrok-free.dev/api/${apiKey}/find_client_id_by_platform_id`;
      let clientId;

      const dataFindClient = {
        platform_ids: [SaleBotPro.recipient_id],
        group_id: '707314'
      };
      fetch(urlFindClient, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(dataFindClient)
      })
      .then(res => res.json())
      .then(json => {
        clientId = json.client_ids ? json.client_ids[0] : null;
        console.log('Client ID:', json.client_ids ? json.client_ids[0] : null);
      })
      .catch(e => console.error('Ошибка FindClient:', e));

      if (clientId) {
        const dataSaveVariables = {
          client_id: clientId,
          variables: {
            campbox_user_id: '763e331f-b605-41fd-b9e9-2f6d7efba714',
          }
        };
        fetch(urlSaveVariables, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(dataSaveVariables)
        })
        .then(response => response.json())
        .then(result => {
          console.log('Campbox user ID отправлен:', result);
        })
        .catch(error => {
          console.error('Ошибка SaveVariables:', error);
        });
      }
    </script>
  </body>
</html>
